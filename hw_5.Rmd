---
title: "Homework 5"
author: "Laura Lynch, LL3255"
date: "11/11/2019"
output: github_document
---

```{r setup, include=FALSE}

library(tidyverse)
library(rvest)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 10, 
  fig.height = 6,
  out.width = "90%"
)
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

# Problem 1
```{r}
# Load the data
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

### Function

Fill in missings in iris dataframe
```{r}
replace_iris = function(x) {
  # If NULL and numeric, replace with mean value for that column
  replace_numeric = mean(x, na.rm = TRUE)
  # If NULL and character, replace with "virginica"
  replace_character = "virginica"
  
  # conditional execution
  if(is.null(.)) {rep(FALSE, replace_numeric)}
  else {rep(FALSE, replace_character)}
  }

# define output dataframe
output = vector(df, length = 4)
# for loop to apply function to dataframe
for (i in 1:150) {
  output[[i]] = replace_iris(df[[i]])
}

# map it
purrr::output = map_df(.x = df, ~ replace_iris(.x))

```


# Problem 2

### Tidy Dataframe
```{r}
# Function to pull in files and create columns

find_files = function(combine) {
  
  z = list.files(path = "./data")
  # Make each row a unique id
  patient = z %>%
    str_extract(" ") %>%
    as.numeric()
  # Extract week variables
  week = z %>%
    str_extract("\\week") %>%
    as.numeric()
  # Extract data
  obs = z %>%
    str_extract(" ") %>%
    as.numeric()

 # Format new data frame 
  data_frame(patient, week, obs)
}

# for loop to apply function to dataframe
output = vector()

for (i in 1:10) {
  output[[i]] = read_page_reviews(vec_urls[[i]])
}

tidy_subject = bind_rows(output)
# map variables onto new df
tidy_subject = map_df(find_files)

# tidy the dataframe
```

### Spagetti Plot (showing observations on each subject over time, and comment on differences between groups)

```{r}
tidy_subject %>% 
  group_by(week, patient) %>% 
  #summarize(mean_exc = mean(data_value)) %>% 
  ggplot(aes(x = week, y = obs, group = patient, color = patient)) +
  geom_path() + 
  labs(caption = "Subject scores over time") + 
  viridis::scale_color_viridis(
    discrete = TRUE) + 
  theme(legend.position = "none")
```


# Problem 3

### Linear Regression Model

```{r}
sim_data = tibble(
  x = rnorm(30, mean = 1, sd = 1),
  y = 2 + 3 * x + rnorm(30, 0, 1)
)

ls_fit = lm(y ~ x, data = sim_data)
  
beta0_hat = coef(ls_fit)[1]
beta1_hat = coef(ls_fit)[2]
```

* Make a plot showing the proportion of times the null was rejected (the power of the test) on the y axis and the true value of β2 on the x axis. Describe the association between effect size and power.
```{r}

```

* Make a plot showing the average estimate of β̂ 1 on the y axis and the true value of β1 on the x axis. Make a second plot (or overlay on the first) the average estimate of β̂ 1 only in samples for which the null was rejected on the y axis and the true value of β1 on the x axis. Is the sample average of β̂ 1 across tests for which the null is rejected approximately equal to the true value of β1? Why or why not?
```{r}

```

